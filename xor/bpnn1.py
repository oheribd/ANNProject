# Back-Propagation Neural Networks
# 
# Written in Python.  See http://www.python.org/
# Placed in the public domain.
# Neil Schemenauer <nas@arctrix.com>
# ภาษาไทย โดย วรรณพงษ์ ภัททิยไพบูลย์ https://python3.wannaphong.com

import math
import random
import string

random.seed(0)

# calculate a random number where:  a <= rand < b
def rand(a, b):
    return (b-a)*random.random() + a

# สร้าง matrix (ถ้าใช้ NumPy จะทำงานได้รวดเร็วขึ้น)
def makeMatrix(I, J, fill=0.0):
    m = []
    for i in range(I):
        m.append([fill]*J)
    return m

# เป็น sigmoid function มีสูตรดังนี้ 1/(1+e^-x)
def sigmoid(x):
    return math.tanh(x)

# derivative of our sigmoid function, in terms of the output (i.e. y)
def dsigmoid(y):
    return 1.0 - y**2

class NN:
    def __init__(self, ni, nh, no):
        # จำนวนของ input, hidden, และ output nodes
        self.ni = ni + 1 # +1 for bias node
        self.nh = nh
        self.no = no

        # activations for nodes
        self.ai = [1.0]*self.ni
        self.ah = [1.0]*self.nh
        self.ao = [1.0]*self.no
        
        # สร้างค่า weights
        self.wi = makeMatrix(self.ni, self.nh)
        self.wo = makeMatrix(self.nh, self.no)
        # set them to random vaules
        for i in range(self.ni):
            for j in range(self.nh):
                self.wi[i][j] = rand(-0.2, 0.2)
        for j in range(self.nh):
            for k in range(self.no):
                self.wo[j][k] = rand(-2.0, 2.0)

        # last change in weights for momentum   
        self.ci = makeMatrix(self.ni, self.nh)
        self.co = makeMatrix(self.nh, self.no)

    def update(self, inputs):
        if len(inputs) != self.ni-1:
            raise ValueError('wrong number of inputs')

        # input activations
        for i in range(self.ni-1):
            #self.ai[i] = sigmoid(inputs[i])
            self.ai[i] = inputs[i]

        # hidden activations
        for j in range(self.nh):
            sum = 0.0
            for i in range(self.ni):
                sum = sum + self.ai[i] * self.wi[i][j]
            self.ah[j] = sigmoid(sum)

        # output activations
        for k in range(self.no):
            sum = 0.0
            for j in range(self.nh):
                sum = sum + self.ah[j] * self.wo[j][k]
            self.ao[k] = sigmoid(sum)

        return self.ao[:]


    def backPropagate(self, targets, N, M):
        if len(targets) != self.no:
            raise ValueError('wrong number of target values')

        # calculate error terms for output
        output_deltas = [0.0] * self.no
        for k in range(self.no):
            error = targets[k]-self.ao[k]
            output_deltas[k] = dsigmoid(self.ao[k]) * error

        # calculate error terms for hidden
        hidden_deltas = [0.0] * self.nh
        for j in range(self.nh):
            error = 0.0
            for k in range(self.no):
                error = error + output_deltas[k]*self.wo[j][k]
            hidden_deltas[j] = dsigmoid(self.ah[j]) * error

        #ปรับปรุงค่า output weights
        for j in range(self.nh):
            for k in range(self.no):
                change = output_deltas[k]*self.ah[j]
                self.wo[j][k] = self.wo[j][k] + N*change + M*self.co[j][k]
                self.co[j][k] = change
                #print N*change, M*self.co[j][k]

        # ปรับปรุงค่า input weights
        for i in range(self.ni):
            for j in range(self.nh):
                change = hidden_deltas[j]*self.ai[i]
                self.wi[i][j] = self.wi[i][j] + N*change + M*self.ci[i][j]
                self.ci[i][j] = change

        # คำนวณค่า error
        error = 0.0
        for k in range(len(targets)):
            error = error + 0.5*(targets[k]-self.ao[k])**2
        return error


    def test(self, patterns):
        for p in patterns:
            print(p[0], '->', self.update(p[0]))

    def weights(self):
        print('Input weights:')
        for i in range(self.ni):
            print(self.wi[i])
        print()
        print('Output weights:')
        for j in range(self.nh):
            print(self.wo[j])

    def train(self, patterns, iterations=1500, N=0.3, M=0.1):
        # N: learning rate
        # M: momentum factor
        # iterations : จำนวนการลูป
        for i in range(iterations):
            error = 0.0
            for p in patterns:
                inputs = p[0]
                targets = p[1]
                self.update(inputs)
                error = error + self.backPropagate(targets, N, M)
            if i % 100 == 0:
                print('error %-.5f' % error) # แสดงค่า error
            



def demo():
    # สอน network XOR function
    pat = [
        [[0,0],[0]],
		[[0.01,0.01],[0]],
		[[0.04,0.04],[0]],
		[[0.07,0.07],[0]],
		[[0.11,0.11],[0]],
		[[0.15,0.15],[0]],
		[[0.19,0.19],[0]],
		[[0.22,0.22],[0]],
		[[0.23,0.23],[0]],
		[[0.26,0.26],[0]],
		[[0.3,0.3],[0]],
		[[0.32,0.32],[0]],
		[[0.38,0.38],[0]],
		[[0.44,0.44],[0]],
		[[0.46,0.46],[0]],
		[[0.49,0.49],[0]],
		[[0.52,0.52],[0]],
		[[0.55,0.55],[0]],
		[[0.56,0.56],[0]],
		[[0.64,0.64],[0]],
		[[0.67,0.67],[0]],
		[[0.71,0.71],[0]],
		[[0.73,0.73],[0]],
		[[0.77,0.77],[0]],
		[[0.8,0.8],[0]],
		[[0.82,0.82],[0]],
		[[0.87,0.87],[0]],
		[[0.93,0.93],[0]],
		[[0.95,0.95],[0]],
		[[0.98,0.98],[0]],
		[[1,1],[0]],
		[[0,0.01],[0]],
		[[0.01,0.04],[0]],
		[[0.04,0.07],[0]],
		[[0.07,0.11],[0]],
		[[0.11,0.15],[0]],
		[[0.15,0.19],[0]],
		[[0.19,0.22],[0]],
		[[0.22,0.23],[0]],
[[0.23,0.26],[0]],
[[0.26,0.3],[0]],
[[0.3,0.32],[0]],
[[0.32,0.38],[0]],
[[0.38,0.44],[0]],
[[0.44,0.46],[0]],
[[0.46,0.49],[0]],
[[0.49,0.52],[1]],
[[0.52,0.55],[0]],
[[0.55,0.56],[0]],
[[0.56,0.62],[0]],
[[0.62,0.64],[0]],
[[0.64,0.67],[0]],
[[0.67,0.71],[0]],
[[0.71,0.73],[0]],
[[0.73,0.77],[0]],
[[0.77,0.8],[0]],
[[0.8,0.82],[0]],
[[0.82,0.87],[0]],
[[0.87,0.93],[0]],
[[0.93,0.95],[0]],
[[0.95,0.98],[0]],
[[0.98,1],[0]],
[[1,0],[1]],
[[0,0.04],[0]],
[[0.01,0.07],[0]],
[[0.04,0.11],[0]],
[[0.07,0.15],[0]],
[[0.11,0.19],[0]],
[[0.15,0.22],[0]],
[[0.19,0.23],[0]],
[[0.22,0.26],[0]],
[[0.23,0.3],[0]],
[[0.26,0.32],[0]],
[[0.3,0.38],[0]],
[[0.32,0.44],[0]],
[[0.38,0.46],[0]],
[[0.44,0.49],[0]],
[[0.46,0.52],[1]],
[[0.49,0.55],[1]],
[[0.52,0.56],[0]],
[[0.55,0.62],[0]],
[[0.56,0.64],[0]],
[[0.62,0.67],[0]],
[[0.64,0.71],[0]],
[[0.67,0.73],[0]],
[[0.71,0.77],[0]],
[[0.73,0.8],[0]],
[[0.77,0.82],[0]],
[[0.8,0.87],[0]],
[[0.82,0.93],[0]],
[[0.87,0.95],[0]],
[[0.93,0.98],[0]],
[[0.95,1],[0]],
[[0.98,0],[1]],
[[1,0.01],[1]],
[[0,0.07],[0]],
[[0.01,0.11],[0]],
[[0.04,0.15],[0]],
[[0.07,0.19],[0]],
[[0.11,0.22],[0]],
[[0.15,0.23],[0]],
[[0.19,0.26],[0]],
[[0.22,0.3],[0]],
[[0.23,0.32],[0]],
[[0.26,0.38],[0]],
[[0.3,0.44],[0]],
[[0.32,0.46],[0]],
[[0.38,0.49],[0]],
[[0.44,0.52],[1]],
[[0.46,0.55],[1]],
[[0.49,0.56],[1]],
[[0.52,0.62],[0]],
[[0.55,0.64],[0]],
[[0.56,0.67],[0]],
[[0.62,0.71],[0]],
[[0.64,0.73],[0]],
[[0.67,0.77],[0]],
[[0.71,0.8],[0]],
[[0.73,0.82],[0]],
[[0.77,0.87],[0]],
[[0.8,0.93],[0]],
[[0.82,0.95],[0]],
[[0.87,0.98],[0]],
[[0.93,1],[0]],
[[0.95,0],[1]],
[[0.98,0.01],[1]],
[[1,0.04],[1]],
[[0,0.11],[0]],
[[0.01,0.15],[0]],
[[0.04,0.19],[0]],
[[0.07,0.22],[0]],
[[0.11,0.23],[0]],
[[0.15,0.26],[0]],
[[0.19,0.3],[0]],
[[0.22,0.32],[0]],
[[0.23,0.38],[0]],
[[0.26,0.44],[0]],
[[0.3,0.46],[0]],
[[0.32,0.49],[0]],
[[0.38,0.52],[1]],
[[0.44,0.55],[1]],
[[0.46,0.56],[1]],
[[0.49,0.62],[1]],
[[0.52,0.64],[0]],
[[0.55,0.67],[0]],
[[0.56,0.71],[0]],
[[0.62,0.73],[0]],
[[0.64,0.77],[0]],
[[0.67,0.8],[0]],
[[0.71,0.82],[0]],
[[0.73,0.87],[0]],
[[0.77,0.93],[0]],
[[0.8,0.95],[0]],
[[0.82,0.98],[0]],
[[0.87,1],[0]],
[[0.93,0],[1]],
[[0.95,0.01],[1]],
[[0.98,0.04],[1]],
[[1,0.07],[1]],
[[0,0.15],[0]],
[[0.01,0.19],[0]],
[[0.04,0.22],[0]],
[[0.07,0.23],[0]],
[[0.11,0.26],[0]],
[[0.15,0.3],[0]],
[[0.19,0.32],[0]],
[[0.22,0.38],[0]],
[[0.23,0.44],[0]],
[[0.26,0.46],[0]],
[[0.3,0.49],[0]],
[[0.32,0.52],[1]],
[[0.38,0.55],[1]],
[[0.44,0.56],[1]],
[[0.46,0.62],[1]],
[[0.49,0.64],[1]],
[[0.52,0.67],[0]],
[[0.55,0.71],[0]],
[[0.56,0.73],[0]],
[[0.62,0.77],[0]],
[[0.64,0.8],[0]],
[[0.67,0.82],[0]],
[[0.71,0.87],[0]],
[[0.73,0.93],[0]],
[[0.77,0.95],[0]],
[[0.8,0.98],[0]],
[[0.82,1],[0]],
[[0.87,0],[1]],
[[0.93,0.01],[1]],
[[0.95,0.04],[1]],
[[0.98,0.07],[1]],
[[1,0.11],[1]],
[[0,0.19],[0]],
[[0.01,0.22],[0]],
[[0.04,0.23],[0]],
[[0.07,0.26],[0]],
[[0.11,0.3],[0]],
[[0.15,0.32],[0]],
[[0.19,0.38],[0]],
[[0.22,0.44],[0]],
[[0.23,0.46],[1]],
[[0.26,0.49],[1]],
[[0.3,0.52],[1]],
[[0.32,0.55],[1]],
[[0.38,0.56],[1]],
[[0.44,0.62],[1]],
[[0.46,0.64],[1]],
[[0.49,0.67],[1]],
[[0.52,0.71],[0]],
[[0.55,0.73],[0]],
[[0.56,0.77],[0]],
[[0.62,0.8],[0]],
[[0.64,0.82],[0]],
[[0.67,0.87],[0]],
[[0.71,0.93],[0]],
[[0.73,0.95],[0]],
[[0.77,0.98],[0]],
[[0.8,1],[0]],
[[0.82,0],[1]],
[[0.87,0.01],[1]],
[[0.93,0.04],[1]],
[[0.95,0.07],[1]],
[[0.98,0.11],[1]],
[[1,0.15],[1]],
[[0,0.22],[0]],
[[0.01,0.23],[0]],
[[0.04,0.26],[0]],
[[0.07,0.3],[0]],
[[0.11,0.32],[0]],
[[0.15,0.38],[0]],
[[0.19,0.44],[0]],
[[0.22,0.46],[0]],
[[0.23,0.49],[0]],
[[0.26,0.52],[1]],
[[0.3,0.55],[1]],
[[0.32,0.56],[1]],
[[0.38,0.62],[1]],
[[0.44,0.64],[1]],
[[0.46,0.67],[1]],
[[0.49,0.71],[1]],
[[0.52,0.73],[0]],
[[0.55,0.77],[0]],
[[0.56,0.8],[0]],
[[0.62,0.82],[0]],
[[0.64,0.87],[0]],
[[0.67,0.93],[0]],
[[0.71,0.95],[0]],
[[0.73,0.98],[0]],
[[0.77,1],[0]],
[[0.8,0],[1]],
[[0.82,0.01],[1]],
[[0.87,0.04],[1]],
[[0.93,0.07],[1]],
[[0.95,0.11],[1]],
[[0.98,0.15],[1]],
[[1,0.19],[1]],
[[0,0.23],[0]],
[[0.01,0.26],[0]],
[[0.04,0.3],[0]],
[[0.07,0.32],[0]],
[[0.11,0.38],[0]],
[[0.15,0.44],[0]],
[[0.19,0.46],[0]],
[[0.22,0.49],[0]],
[[0.23,0.52],[1]],
[[0.26,0.55],[1]],
[[0.3,0.56],[1]],
[[0.32,0.62],[1]],
[[0.38,0.64],[1]],
[[0.44,0.67],[1]],
[[0.46,0.71],[1]],
[[0.49,0.73],[1]],
[[0.52,0.77],[0]],
[[0.55,0.8],[0]],
[[0.56,0.82],[0]],
[[0.62,0.87],[0]],
[[0.64,0.93],[0]],
[[0.67,0.95],[0]],
[[0.71,0.98],[0]],
[[0.73,1],[0]],
[[0.77,0],[1]],
[[0.8,0.01],[1]],
[[0.82,0.04],[1]],
[[0.87,0.07],[1]],
[[0.93,0.11],[1]],
[[0.95,0.15],[1]],
[[0.98,0.19],[1]],
[[1,0.22],[1]],
[[0,0.26],[0]],
[[0.01,0.3],[0]],
[[0.04,0.32],[0]],
[[0.07,0.38],[0]],
[[0.11,0.44],[0]],
[[0.15,0.46],[0]],
[[0.19,0.49],[0]],
[[0.22,0.52],[1]],
[[0.23,0.55],[1]],
[[0.26,0.56],[1]],
[[0.3,0.62],[1]],
[[0.32,0.64],[1]],
[[0.38,0.67],[1]],
[[0.44,0.71],[1]],
[[0.46,0.73],[1]],
[[0.49,0.77],[1]],
[[0.52,0.8],[0]],
[[0.55,0.82],[0]],
[[0.56,0.87],[0]],
[[0.62,0.93],[0]],
[[0.64,0.95],[0]],
[[0.67,0.98],[0]],
[[0.71,1],[0]],
[[0.73,0],[1]],
[[0.77,0.01],[1]],
[[0.8,0.04],[1]],
[[0.82,0.07],[1]],
[[0.87,0.11],[1]],
[[0.93,0.15],[1]],
[[0.95,0.19],[1]],
[[0.98,0.22],[1]],
[[1,0.23],[1]],
[[0,0.3],[0]],
[[0.01,0.32],[0]],
[[0.04,0.38],[0]],
[[0.07,0.44],[0]],
[[0.11,0.46],[0]],
[[0.15,0.49],[0]],
[[0.19,0.52],[1]],
[[0.22,0.55],[1]],
[[0.23,0.56],[1]],
[[0.26,0.62],[1]],
[[0.3,0.64],[1]],
[[0.32,0.67],[1]],
[[0.38,0.71],[1]],
[[0.44,0.73],[1]],
[[0.46,0.77],[1]],
[[0.49,0.8],[1]],
[[0.52,0.82],[0]],
[[0.55,0.87],[0]],
[[0.56,0.93],[0]],
[[0.62,0.95],[0]],
[[0.64,0.98],[0]],
[[0.67,1],[0]],
[[0.71,0],[1]],
[[0.73,0.01],[1]],
[[0.77,0.04],[1]],
[[0.8,0.07],[1]],
[[0.82,0.11],[1]],
[[0.87,0.15],[1]],
[[0.93,0.19],[1]],
[[0.95,0.22],[1]],
[[0.98,0.23],[1]],
[[1,0.26],[1]],
[[0,0.32],[0]],
[[0.01,0.38],[0]],
[[0.04,0.44],[0]],
[[0.07,0.46],[0]],
[[0.11,0.49],[0]],
[[0.15,0.52],[1]],
[[0.19,0.55],[1]],
[[0.22,0.56],[1]],
[[0.23,0.62],[1]],
[[0.26,0.64],[1]],
[[0.3,0.67],[1]],
[[0.32,0.71],[1]],
[[0.38,0.73],[1]],
[[0.44,0.77],[1]],
[[0.46,0.8],[1]],
[[0.49,0.82],[1]],
[[0.52,0.87],[0]],
[[0.55,0.93],[0]],
[[0.56,0.95],[0]],
[[0.62,0.98],[0]],
[[0.64,1],[0]],
[[0.67,0],[1]],
[[0.71,0.01],[1]],
[[0.73,0.04],[1]],
[[0.77,0.07],[1]],
[[0.8,0.11],[1]],
[[0.82,0.15],[1]],
[[0.87,0.19],[1]],
[[0.93,0.22],[1]],
[[0.95,0.23],[1]],
[[0.98,0.26],[1]],
[[1,0.3],[1]],
[[0,0.38],[0]],
[[0.01,0.44],[0]],
[[0.04,0.46],[0]],
[[0.07,0.49],[0]],
[[0.11,0.52],[1]],
[[0.15,0.55],[1]],
[[0.19,0.56],[1]],
[[0.22,0.62],[1]],
[[0.23,0.64],[1]],
[[0.26,0.67],[1]],
[[0.3,0.71],[1]],
[[0.32,0.73],[1]],
[[0.38,0.77],[1]],
[[0.44,0.8],[1]],
[[0.46,0.82],[1]],
[[0.49,0.87],[1]],
[[0.52,0.93],[0]],
[[0.55,0.95],[0]],
[[0.56,0.98],[0]],
[[0.62,1],[0]],
[[0.64,0],[1]],
[[0.67,0.01],[1]],
[[0.71,0.04],[1]],
[[0.73,0.07],[1]],
[[0.77,0.11],[1]],
[[0.8,0.15],[1]],
[[0.82,0.19],[1]],
[[0.87,0.22],[1]],
[[0.93,0.23],[1]],
[[0.95,0.26],[1]],
[[0.98,0.3],[1]],
[[1,0.32],[1]],
[[0,0.44],[0]],
[[0.01,0.46],[0]],
[[0.04,0.49],[0]],
[[0.07,0.52],[1]],
[[0.11,0.55],[1]],
[[0.15,0.56],[1]],
[[0.19,0.62],[1]],
[[0.22,0.64],[1]],
[[0.23,0.67],[1]],
[[0.26,0.71],[1]],
[[0.3,0.73],[1]],
[[0.32,0.77],[1]],
[[0.38,0.82],[1]],
[[0.44,0.82],[1]],
[[0.46,0.87],[1]],
[[0.49,0.93],[1]],
[[0.52,0.95],[0]],
[[0.55,0.98],[0]],
[[0.56,1],[0]],
[[0.62,0],[1]],
[[0.64,0.01],[1]],
[[0.67,0.04],[1]],
[[0.71,0.07],[1]],
[[0.73,0.11],[1]],
[[0.77,0.15],[1]],
[[0.8,0.19],[1]],
[[0.82,0.22],[1]],
[[0.87,0.23],[1]],
[[0.93,0.26],[1]],
[[0.95,0.3],[1]],
[[0.98,0.32],[1]],
[[1,0.38],[1]],
[[0,0.46],[0]],
[[0.01,0.49],[0]],
[[0.04,0.52],[1]],
[[0.07,0.55],[1]],
[[0.11,0.56],[1]],
[[0.15,0.62],[1]],
[[0.19,0.64],[1]],
[[0.22,0.67],[1]],
[[0.23,0.71],[1]],
[[0.26,0.73],[1]],
[[0.3,0.8],[1]],
[[0.32,0.8],[1]],
[[0.38,0.82],[1]],
[[0.44,0.87],[1]],
[[0.46,0.93],[1]],
[[0.49,0.95],[1]],
[[0.52,0.98],[0]],
[[0.55,1],[0]],
[[0.56,0],[1]],
[[0.62,0.01],[1]],
[[0.64,0.04],[1]],
[[0.67,0.07],[1]],
[[0.71,0.11],[1]],
[[0.73,0.15],[1]],
[[0.77,0.19],[1]],
[[0.8,0.22],[1]],
[[0.82,0.23],[1]],
[[0.87,0.26],[1]],
[[0.93,0.3],[1]],
[[0.95,0.32],[1]],
[[0.98,0.38],[1]],
[[1,0.44],[1]],
[[0,0.49],[0]],
[[0.01,0.52],[1]],
[[0.04,0.55],[1]],
[[0.07,0.56],[1]],
[[0.11,0.62],[1]],
[[0.15,0.64],[1]],
[[0.19,0.67],[1]],
[[0.22,0.71],[1]],
[[0.23,0.73],[1]],
[[0.26,0.77],[1]],
[[0.3,0.8],[1]],
[[0.32,0.82],[1]],
[[0.38,0.87],[1]],
[[0.44,0.93],[1]],
[[0.46,0.95],[1]],
[[0.49,0.98],[1]],
[[0.52,1],[0]],
[[0.55,0],[1]],
[[0.56,0.01],[1]],
[[0.62,0.04],[1]],
[[0.64,0.07],[1]],
[[0.67,0.11],[1]],
[[0.71,0.15],[1]],
[[0.73,0.19],[1]],
[[0.77,0.22],[1]],
[[0.8,0.23],[1]],
[[0.82,0.26],[1]],
[[0.87,0.3],[1]],
[[0.93,0.32],[1]],
[[0.95,0.38],[1]],
[[0.98,0.44],[1]],
[[1,0.46],[0]],
[[0,0.52],[1]],
[[0.01,0.55],[1]],
[[0.04,0.56],[1]],
[[0.07,0.62],[1]],
[[0.11,0.64],[1]],
[[0.15,0.67],[1]],
[[0.19,0.71],[1]],
[[0.22,0.73],[1]],
[[0.23,0.77],[1]],
[[0.26,0.8],[1]],
[[0.3,0.82],[1]],
[[0.32,0.87],[1]],
[[0.38,0.93],[1]],
[[0.44,0.95],[1]],
[[0.46,0.98],[0]],
[[0.49,1],[0]],
[[0.52,0],[1]],
[[0.55,0.01],[1]],
[[0.56,0.04],[1]],
[[0.62,0.07],[1]],
[[0.64,0.11],[1]],
[[0.67,0.15],[1]],
[[0.71,0.19],[1]],
[[0.73,0.22],[1]],
[[0.77,0.23],[1]],
[[0.8,0.26],[1]],
[[0.82,0.3],[1]],
[[0.87,0.32],[1]],
[[0.93,0.38],[1]],
[[0.95,0.44],[1]],
[[0.98,0.46],[0]],
[[1,0.49],[0]],
[[0,0.55],[1]],
[[0.01,0.56],[1]],
[[0.04,0.62],[1]],
[[0.07,0.64],[1]],
[[0.11,0.67],[1]],
[[0.15,0.71],[1]],
[[0.19,0.73],[1]],
[[0.22,0.77],[1]],
[[0.23,0.8],[1]],
[[0.26,0.82],[1]],
[[0.3,0.87],[1]],
[[0.32,0.93],[1]],
[[0.38,0.95],[1]],
[[0.44,0.98],[1]],
[[0.46,1],[0]],
[[0.49,0],[1]],
[[0.52,0.01],[1]],
[[0.55,0.04],[1]],
[[0.56,0.07],[1]],
[[0.62,0.11],[1]],
[[0.64,0.15],[1]],
[[0.67,0.19],[1]],
[[0.71,0.22],[1]],
[[0.73,0.23],[1]],
[[0.77,0.26],[1]],
[[0.8,0.3],[1]],
[[0.82,0.32],[1]],
[[0.87,0.38],[1]],
[[0.93,0.44],[1]],
[[0.95,0.46],[0]],
[[0.98,0.49],[0]],
[[1,0.52],[0]],
[[0,0.56],[1]],
[[0.01,0.62],[1]],
[[0.04,0.64],[1]],
[[0.07,0.67],[1]],
[[0.11,0.71],[1]],
[[0.15,0.73],[1]],
[[0.19,0.77],[1]],
[[0.22,0.8],[1]],
[[0.23,0.82],[1]],
[[0.26,0.87],[1]],
[[0.3,0.93],[1]],
[[0.32,0.95],[1]],
[[0.38,0.98],[1]],
[[0.44,1],[1]],
[[0.46,0],[1]],
[[0.49,0.01],[1]],
[[0.52,0.04],[1]],
[[0.55,0.07],[1]],
[[0.56,0.11],[1]],
[[0.62,0.15],[1]],
[[0.64,0.19],[1]],
[[0.67,0.22],[1]],
[[0.71,0.23],[1]],
[[0.73,0.26],[1]],
[[0.77,0.3],[1]],
[[0.8,0.32],[1]],
[[0.82,0.38],[1]],
[[0.87,0.44],[1]],
[[0.93,0.46],[0]],
[[0.95,0.49],[0]],
[[0.98,0.52],[0]],
[[1,0.55],[0]],
[[0,0.62],[1]],
[[0.01,0.64],[1]],
[[0.04,0.67],[1]],
[[0.07,0.71],[1]],
[[0.11,0.73],[1]],
[[0.15,0.77],[1]],
[[0.19,0.8],[1]],
[[0.22,0.82],[1]],
[[0.23,0.87],[1]],
[[0.26,0.93],[1]],
[[0.3,0.95],[1]],
[[0.32,0.98],[1]],
[[0.38,1],[1]],
[[0.44,0],[0]],
[[0.46,0.01],[1]],
[[0.49,0.04],[1]],
[[0.52,0.07],[1]],
[[0.55,0.11],[1]],
[[0.56,0.15],[1]],
[[0.62,0.19],[1]],
[[0.64,0.22],[1]],
[[0.67,0.23],[1]],
[[0.71,0.26],[1]],
[[0.73,0.3],[1]],
[[0.77,0.32],[1]],
[[0.8,0.38],[1]],
[[0.82,0.44],[1]],
[[0.87,0.46],[0]],
[[0.93,0.49],[0]],
[[0.95,0.52],[0]],
[[0.98,0.55],[0]],
[[1,0.56],[0]],
[[0,0.64],[1]],
[[0.01,0.67],[1]],
[[0.04,0.71],[1]],
[[0.07,0.73],[1]],
[[0.11,0.77],[1]],
[[0.15,0.8],[1]],
[[0.19,0.82],[1]],
[[0.22,0.87],[1]],
[[0.23,0.93],[1]],
[[0.26,0.95],[1]],
[[0.3,0.98],[1]],
[[0.32,1],[1]],
[[0.38,0],[0]],
[[0.44,0.01],[0]],
[[0.46,0.04],[1]],
[[0.49,0.07],[1]],
[[0.52,0.11],[1]],
[[0.55,0.15],[1]],
[[0.56,0.19],[1]],
[[0.62,0.22],[1]],
[[0.64,0.23],[1]],
[[0.67,0.26],[1]],
[[0.71,0.3],[1]],
[[0.73,0.32],[1]],
[[0.77,0.38],[1]],
[[0.8,0.44],[1]],
[[0.82,0.46],[0]],
[[0.87,0.49],[0]],
[[0.93,0.52],[0]],
[[0.95,0.55],[0]],
[[0.98,0.56],[0]],
[[1,0.62],[0]],
[[0,0.67],[1]],
[[0.01,0.71],[1]],
[[0.04,0.73],[1]],
[[0.07,0.77],[1]],
[[0.11,0.8],[1]],
[[0.15,0.82],[1]],
[[0.19,0.87],[1]],
[[0.22,0.93],[1]],
[[0.23,0.95],[1]],
[[0.26,0.98],[1]],
[[0.3,1],[1]],
[[0.32,0],[0]],
[[0.38,0.01],[0]],
[[0.44,0.04],[0]],
[[0.46,0.07],[1]],
[[0.49,0.11],[1]],
[[0.52,0.15],[1]],
[[0.55,0.19],[1]],
[[0.56,0.22],[1]],
[[0.62,0.23],[1]],
[[0.64,0.26],[1]],
[[0.67,0.3],[1]],
[[0.71,0.32],[1]],
[[0.73,0.38],[1]],
[[0.77,0.44],[1]],
[[0.8,0.46],[0]],
[[0.82,0.49],[0]],
[[0.87,0.52],[0]],
[[0.93,0.55],[0]],
[[0.95,0.56],[0]],
[[0.98,0.62],[0]],
[[1,0.64],[0]],
[[0,0.71],[1]],
[[0.01,0.73],[1]],
[[0.04,0.77],[1]],
[[0.07,0.8],[1]],
[[0.11,0.82],[1]],
[[0.15,0.87],[1]],
[[0.19,0.93],[1]],
[[0.22,0.95],[1]],
[[0.23,0.98],[1]],
[[0.26,1],[1]],
[[0.3,0],[0]],
[[0.32,0.01],[0]],
[[0.38,0.04],[0]],
[[0.44,0.07],[0]],
[[0.46,0.11],[1]],
[[0.49,0.15],[1]],
[[0.52,0.19],[1]],
[[0.55,0.22],[1]],
[[0.56,0.23],[1]],
[[0.62,0.26],[1]],
[[0.64,0.3],[1]],
[[0.67,0.32],[1]],
[[0.71,0.38],[1]],
[[0.73,0.44],[1]],
[[0.77,0.46],[0]],
[[0.8,0.49],[0]],
[[0.82,0.52],[0]],
[[0.87,0.55],[0]],
[[0.93,0.56],[0]],
[[0.95,0.62],[0]],
[[0.98,0.64],[0]],
[[1,0.67],[0]],
[[0,0.73],[1]],
[[0.01,0.77],[1]],
[[0.04,0.8],[1]],
[[0.07,0.82],[1]],
[[0.11,0.87],[1]],
[[0.15,0.93],[1]],
[[0.19,0.95],[1]],
[[0.22,0.98],[1]],
[[0.23,1],[1]],
[[0.26,0],[0]],
[[0.3,0.01],[0]],
[[0.32,0.04],[0]],
[[0.38,0.07],[0]],
[[0.44,0.11],[0]],
[[0.46,0.15],[1]],
[[0.49,0.19],[1]],
[[0.52,0.22],[1]],
[[0.55,0.23],[1]],
[[0.56,0.26],[1]],
[[0.62,0.3],[1]],
[[0.64,0.32],[1]],
[[0.67,0.38],[1]],
[[0.71,0.44],[1]],
[[0.73,0.46],[0]],
[[0.77,0.49],[0]],
[[0.8,0.52],[0]],
[[0.82,0.55],[0]],
[[0.87,0.56],[0]],
[[0.93,0.62],[0]],
[[0.95,0.64],[0]],
[[0.98,0.67],[0]],
[[1,0.71],[0]],
[[0,0.77],[1]],
[[0.01,0.8],[1]],
[[0.04,0.82],[1]],
[[0.07,0.87],[1]],
[[0.11,0.93],[1]],
[[0.15,0.95],[1]],
[[0.19,0.98],[1]],
[[0.22,1],[1]],
[[0.23,0],[0]],
[[0.26,0.01],[0]],
[[0.3,0.04],[0]],
[[0.32,0.07],[0]],
[[0.38,0.11],[0]],
[[0.44,0.15],[0]],
[[0.46,0.19],[1]],
[[0.49,0.22],[1]],
[[0.52,0.23],[1]],
[[0.55,0.26],[1]],
[[0.56,0.3],[1]],
[[0.62,0.32],[1]],
[[0.64,0.38],[1]],
[[0.67,0.44],[1]],
[[0.71,0.46],[0]],
[[0.73,0.49],[0]],
[[0.77,0.52],[0]],
[[0.8,0.55],[0]],
[[0.82,0.56],[0]],
[[0.87,0.62],[0]],
[[0.93,0.64],[0]],
[[0.95,0.67],[0]],
[[0.98,0.71],[0]],
[[1,0.73],[0]],
[[0,0.8],[1]],
[[0.01,0.82],[1]],
[[0.04,0.87],[1]],
[[0.07,0.93],[1]],
[[0.11,0.95],[1]],
[[0.15,0.98],[1]],
[[0.19,1],[1]],
[[0.22,0],[0]],
[[0.23,0.01],[0]],
[[0.26,0.04],[0]],
[[0.3,0.07],[0]],
[[0.32,0.11],[0]],
[[0.38,0.15],[0]],
[[0.44,0.19],[0]],
[[0.46,0.22],[1]],
[[0.49,0.23],[1]],
[[0.52,0.26],[1]],
[[0.55,0.3],[1]],
[[0.56,0.32],[1]],
[[0.62,0.38],[1]],
[[0.64,0.44],[1]],
[[0.67,0.46],[0]],
[[0.71,0.49],[0]],
[[0.73,0.52],[0]],
[[0.77,0.55],[0]],
[[0.8,0.56],[0]],
[[0.82,0.62],[0]],
[[0.87,0.64],[0]],
[[0.93,0.67],[0]],
[[0.95,0.71],[0]],
[[0.98,0.73],[0]],
[[1,0.77],[0]],
[[0,0.82],[1]],
[[0.01,0.87],[1]],
[[0.04,0.93],[1]],
[[0.07,0.95],[1]],
[[0.11,0.98],[1]],
[[0.15,1],[1]],
[[0.19,0],[0]],
[[0.22,0.01],[0]],
[[0.23,0.04],[0]],
[[0.26,0.07],[0]],
[[0.3,0.11],[0]],
[[0.32,0.15],[0]],
[[0.38,0.19],[0]],
[[0.44,0.22],[0]],
[[0.46,0.23],[1]],
[[0.49,0.26],[1]],
[[0.52,0.3],[1]],
[[0.55,0.32],[1]],
[[0.56,0.38],[1]],
[[0.62,0.44],[1]],
[[0.64,0.46],[0]],
[[0.67,0.49],[0]],
[[0.71,0.52],[0]],
[[0.73,0.55],[0]],
[[0.77,0.56],[0]],
[[0.8,0.62],[0]],
[[0.82,0.64],[0]],
[[0.87,0.67],[0]],
[[0.93,0.71],[0]],
[[0.95,0.73],[0]],
[[0.98,0.77],[0]],
[[1,0.8],[0]],
[[0,0.87],[1]],
[[0.01,0.93],[1]],
[[0.04,0.95],[1]],
[[0.07,0.98],[1]],
[[0.11,1],[1]],
[[0.15,0],[0]],
[[0.19,0.01],[0]],
[[0.22,0.04],[0]],
[[0.23,0.07],[0]],
[[0.26,0.11],[0]],
[[0.3,0.15],[0]],
[[0.32,0.19],[0]],
[[0.38,0.22],[0]],
[[0.44,0.23],[0]],
[[0.46,0.26],[1]],
[[0.49,0.3],[1]],
[[0.52,0.32],[1]],
[[0.55,0.38],[1]],
[[0.56,0.44],[1]],
[[0.62,0.46],[0]],
[[0.64,0.49],[0]],
[[0.67,0.52],[0]],
[[0.71,0.55],[0]],
[[0.73,0.56],[0]],
[[0.77,0.62],[0]],
[[0.8,0.64],[0]],
[[0.82,0.67],[0]],
[[0.87,0.71],[0]],
[[0.93,0.73],[0]],
[[0.95,0.77],[0]],
[[0.98,0.8],[0]],
[[1,0.82],[0]],
[[0,0.93],[1]],
[[0.01,0.95],[1]],
[[0.04,0.98],[1]],
[[0.07,1],[1]],
[[0.11,0],[0]],
[[0.15,0.01],[0]],
[[0.19,0.04],[0]],
[[0.22,0.07],[0]],
[[0.23,0.11],[0]],
[[0.26,0.15],[0]],
[[0.3,0.19],[0]],
[[0.32,0.22],[0]],
[[0.38,0.23],[0]],
[[0.44,0.26],[0]],
[[0.46,0.3],[0]],
[[0.49,0.32],[0]],
[[0.52,0.38],[1]],
[[0.55,0.44],[1]],
[[0.56,0.46],[1]],
[[0.62,0.49],[1]],
[[0.64,0.52],[0]],
[[0.67,0.55],[0]],
[[0.71,0.56],[0]],
[[0.73,0.62],[0]],
[[0.77,0.64],[0]],
[[0.8,0.67],[0]],
[[0.82,0.71],[0]],
[[0.87,0.73],[0]],
[[0.93,0.77],[0]],
[[0.95,0.8],[0]],
[[0.98,0.82],[0]],
[[1,0.87],[0]],
[[0,0.95],[1]],
[[0.01,0.98],[1]],
[[0.04,1],[1]],
[[0.07,0],[0]],
[[0.11,0.01],[0]],
[[0.15,0.04],[0]],
[[0.19,0.07],[0]],
[[0.22,0.11],[0]],
[[0.23,0.15],[0]],
[[0.26,0.19],[0]],
[[0.3,0.22],[0]],
[[0.32,0.23],[0]],
[[0.38,0.26],[0]],
[[0.44,0.3],[0]],
[[0.46,0.32],[0]],
[[0.49,0.38],[0]],
[[0.52,0.44],[1]],
[[0.55,0.46],[1]],
[[0.56,0.49],[1]],
[[0.62,0.52],[0]],
[[0.64,0.55],[0]],
[[0.67,0.56],[0]],
[[0.71,0.62],[0]],
[[0.73,0.64],[0]],
[[0.77,0.67],[0]],
[[0.8,0.71],[0]],
[[0.82,0.73],[0]],
[[0.87,0.77],[0]],
[[0.93,0.8],[0]],
[[0.95,0.82],[0]],
[[0.98,0.87],[0]],
[[1,0.93],[0]],
[[0,0.98],[1]],
[[0.01,1],[1]],
[[0.04,0],[0]],
[[0.07,0.01],[0]],
[[0.11,0.04],[0]],
[[0.15,0.07],[0]],
[[0.19,0.11],[0]],
[[0.22,0.15],[0]],
[[0.23,0.19],[0]],
[[0.26,0.22],[0]],
[[0.3,0.23],[0]],
[[0.32,0.26],[0]],
[[0.38,0.3],[0]],
[[0.44,0.32],[0]],
[[0.46,0.38],[0]],
[[0.49,0.44],[0]],
[[0.52,0.46],[1]],
[[0.55,0.49],[1]],
[[0.56,0.52],[0]],
[[0.62,0.55],[0]],
[[0.64,0.56],[0]],
[[0.67,0.62],[0]],
[[0.71,0.64],[0]],
[[0.73,0.67],[0]],
[[0.77,0.71],[0]],
[[0.8,0.73],[0]],
[[0.82,0.77],[0]],
[[0.87,0.8],[0]],
[[0.93,0.82],[0]],
[[0.95,0.87],[0]],
[[0.98,0.93],[0]],
[[1,0.95],[0]],
[[0,1],[1]],
[[0.01,0],[0]],
[[0.04,0.01],[0]],
[[0.07,0.04],[0]],
[[0.11,0.07],[0]],
[[0.15,0.11],[0]],
[[0.19,0.15],[0]],
[[0.22,0.19],[0]],
[[0.23,0.22],[0]],
[[0.26,0.23],[0]],
[[0.3,0.26],[0]],
[[0.32,0.3],[0]],
[[0.38,0.32],[0]],
[[0.44,0.38],[0]],
[[0.46,0.44],[0]],
[[0.49,0.46],[0]],
[[0.52,0.49],[1]],
[[0.55,0.52],[0]],
[[0.56,0.55],[0]],
[[0.62,0.56],[0]],
[[0.64,0.62],[0]],
[[0.67,0.64],[0]],
[[0.71,0.67],[0]],
[[0.73,0.71],[0]],
[[0.77,0.73],[0]],
[[0.8,0.77],[0]],
[[0.82,0.8],[0]],
[[0.87,0.82],[0]],
[[0.93,0.87],[0]],
[[0.95,0.93],[0]],
[[0.98,0.95],[0]],
[[1,0.98],[0]]
    ]

    tes = [
    	[[0.61,0.39]],
    	[[0.63,0.37]],
    	[[0.65,0.35]],
    	[[0.66,0.33]],
    	[[0.68,0.31]],
    	[[0.7,0.29]],
    	[[0.72,0.27]],
    	[[0.74,0.25]],
    	[[0.76,0.24]],
    	[[0.78,0.21]],
    	[[0.81,0.17]],
    	[[0.83,0.16]],
    	[[0.84,0.13]],
    	[[0.86,0.11]],
    	[[0.88,0.1]],
    	[[0.92,0.08]],
    	[[0.94,0.06]],
    	[[0.96,0.05]],
    	[[0.97,0.03]],
    	[[0.99,0.02]]
    ]
    # สร้างโครงข่ายด้วย 2 input layer , 2 hidden layer และ 1 output layer
    n = NN(2, 2, 1)
    # train ด้วย patterns
    n.train(pat)
    # test it
    n.test(tes)



if __name__ == '__main__':
    demo()

